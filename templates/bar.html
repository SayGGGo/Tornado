<div class="container">
    <div class="sidebar" id="sidebar">
        <div class="header">
            <button class="menu-btn">
                <svg viewBox="0 0 24 24">
                    <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                </svg>
            </button>
            <div class="search-container">
                <input type="text" class="search-bar" placeholder="Поиск">
                <svg class="search-icon" viewBox="0 0 24 24">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
                <div class="tornado-text">
                    <span style="--i:1">T</span>
                    <span style="--i:2">o</span>
                    <span style="--i:3">r</span>
                    <span style="--i:4">n</span>
                    <span style="--i:5">a</span>
                    <span style="--i:6">d</span>
                    <span style="--i:7">o</span>
                </div>
            </div>
        </div>

        <div class="folders-container">
            {% for folder in folders %}
            <div class="folder-tab {% if folder.active %}active{% endif %}">
                {{ folder.name }}
                {% if folder.count > 0 %}
                <span class="folder-badge {% if not folder.active %}muted{% endif %}">{{ folder.count }}</span>
                {% endif %}
            </div>
            {% endfor %}
        </div>

        <div class="chat-list">
            {% for chat_id, chat in msg_data.items() %}
            <div class="chat-item {% if chat.active %}active{% endif %}" data-chat-id="{{ chat_id }}">
                <img src="{{ chat.avatar }}" alt="Avatar" class="avatar">
                <div class="chat-info">
                    <div class="chat-header">
                        <div class="chat-name">
                            {{ chat.name }}
                            {% if chat.premium %}
                            <div class="premium-icon" style="-webkit-mask-image: url('{{ url_for('static', filename='premium/' ~ chat.premium ~ '.svg') }}'); mask-image: url('{{ url_for('static', filename='premium/' ~ chat.premium ~ '.svg') }}');"></div>
                            {% endif %}
                            {% if chat.muted %}
                            <span class="icon-muted">
                                <svg viewBox="0 0 24 24"><path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/></svg>
                            </span>
                            {% endif %}
                        </div>
                        <div class="chat-meta">
                            <span class="chat-time">
                                {% if chat.last_status %}
                                <span class="icon-read">
                                    <svg viewBox="0 0 24 24"><polyline points="18 6 7 17 2 12"></polyline><polyline points="22 6 11 17 11 17"></polyline></svg>
                                </span>
                                {% endif %}
                                {{ chat.last_time }}
                            </span>
                        </div>
                    </div>
                    <div class="chat-message-row">
                        <span class="msg-text">{{ chat.last_msg }}</span>
                        <div class="chat-meta">
                            {% if chat.pinned %}
                            <span class="icon-pin">
                                <svg viewBox="0 0 24 24"><path d="M16 12V4h1V2H7v2h1v8l-2 2v2h5.2v6h1.6v-6H18v-2l-2-2z"/></svg>
                            </span>
                            {% endif %}
                            {% if chat.unread > 0 %}
                            <span class="unread-badge {% if chat.muted %}muted{% endif %}">{{ chat.unread }}</span>
                            {% endif %}
                        </div>
                    </div>
                    <div class="chat-tags">
                        {% for tag in chat.tags %}
                        <span class="chat-tag" style="color: {{ tag.color }}; border: 1px solid {{ tag.color }}40;">{{ tag.name }}</span>
                        {% endfor %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <div class="resizer" id="resizer"></div>

    <div class="main-content" id="main-chat-connection-point">
    </div>
</div>